<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate different scenarios of abundance change in entities — simData • treeclimbR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate different scenarios of abundance change in entities — simData"><meta property="og:description" content="Simulate a data set with different abundance patterns for entities under
different conditions. These entities have their corresponding nodes on a
tree."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">treeclimbR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/treeclimbR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/csoneson/treeclimbR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate different scenarios of abundance change in entities</h1>
    <small class="dont-index">Source: <a href="https://github.com/csoneson/treeclimbR/blob/HEAD/R/simData.R" class="external-link"><code>R/simData.R</code></a></small>
    <div class="hidden name"><code>simData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate a data set with different abundance patterns for entities under
different conditions. These entities have their corresponding nodes on a
tree.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simData</span><span class="op">(</span></span>
<span>  tree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  obj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scenario <span class="op">=</span> <span class="st">"BS"</span>,</span>
<span>  from.A <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  from.B <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minTip.A <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  maxTip.A <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  minTip.B <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  maxTip.B <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  minPr.A <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  maxPr.A <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ratio <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  adjB <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pct <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  nSam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">sum</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>tree</dt>
<dd><p>A <code>phylo</code> object. Only used when <code>obj</code> is <code>NULL</code>.</p></dd>


<dt>data</dt>
<dd><p>A count matrix with entities corresponding to tree leaves
in the rows and samples in the columns. Only used when <code>obj</code> is
<code>NULL</code>.</p></dd>


<dt>obj</dt>
<dd><p>A <code>TreeSummarizedExperiment</code> object with observed data to
use as the input for the simulation. If <code>NULL</code>, <code>data</code> and \
<code>tree</code> must be provided instead.</p></dd>


<dt>assay</dt>
<dd><p>If <code>obj</code> is not <code>NULL</code>, a numeric index or
character scalar indicating which assay of the object to use as the
basis for simulation. If <code>assay</code> is <code>NULL</code>, the first
assay in the object is used.</p></dd>


<dt>scenario</dt>
<dd><p>The simulation scenario, either “BS”, “US”,
or “SS” (see <b>Details</b>).</p></dd>


<dt>from.A, from.B</dt>
<dd><p>The branch node labels of branches A and B for which the
signal will be swapped. By default, both are <code>NULL</code>, in which case
they will be chosen based on the restrictions provided (<code>minTip.A</code>,
<code>maxTip.A</code>, <code>minTip.B</code>, <code>maxTip.B</code>, <code>minPr.A</code>,
<code>maxPr.A</code>, <code>ratio</code>). Note: If <code>from.A</code> is <code>NULL</code>,
<code>from.B</code> is also set to <code>NULL</code>.</p></dd>


<dt>minTip.A</dt>
<dd><p>The minimum number of leaves allowed in branch A.</p></dd>


<dt>maxTip.A</dt>
<dd><p>The maximum number of leaves allowed in branch A.</p></dd>


<dt>minTip.B</dt>
<dd><p>The minimum number of leaves allowed in branch B.</p></dd>


<dt>maxTip.B</dt>
<dd><p>The maximum number of leaves allowed in branch B.</p></dd>


<dt>minPr.A</dt>
<dd><p>A numeric value in [0, 1]. The minimum abundance
proportion of leaves in branch A.</p></dd>


<dt>maxPr.A</dt>
<dd><p>A numeric value  in [0, 1]. The maximum abundance
proportion of leaves in branch A.</p></dd>


<dt>ratio</dt>
<dd><p>A numeric value. The proportion ratio of branch B to branch A.
This value is used to select branches(see <b>Details</b>). If there are
no branches having exactly this ratio, the pair with the value closest to
<code>ratio</code> will be selected.</p></dd>


<dt>adjB</dt>
<dd><p>A numeric value in [0, 1] (only for <code>scenario</code>
“SS”), or <code>NULL</code>. If <code>NULL</code>, branch A and the selected
part of branch B swap their proportions. If a numeric value, e.g. 0.1,
then the counts for the selected part of branch B decreases to 10<!-- % of -->
the original value, and this decrease is added to branch A. For example,
assume there are two experimental conditions (C1 &amp; C2), branch A has
a count of 10 and branch B has a count of 40 in C1. If adjB is set to
0.1, then in C2 branch B becomes 4 and branch A 46
so that the total count of the two branches stays the same.</p></dd>


<dt>pct</dt>
<dd><p>The percentage of leaves in branch B that have differential
abundance under different conditions (only for scenario “SS”).</p></dd>


<dt>nSam</dt>
<dd><p>A numeric vector of length 2, indicating the sample size for each
of the two simulated conditions.</p></dd>


<dt>mu, size</dt>
<dd><p>The parameters of the Negative Binomial distribution. (see mu
and size in <code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></code>). These parameters
are used to generate the library size for each simulated sample. If
<code>size</code> is not specified, <code>mu</code> should be a vector of numbers
from which the library size is sampled with replacement.</p></dd>


<dt>n</dt>
<dd><p>A numeric value to specify how many count tables would be generated
with the same settings. The default is 1, i.e., one count table would be
obtained at the end. If greater than 1, the output is a list of matrices.</p></dd>


<dt>FUN</dt>
<dd><p>A function to calculate the aggregated count at each internal
node based on its descendant leaves (e.g., <code>sum</code>, <code>mean</code>).
The argument of the function should be a numeric vector with the counts
of an internal node's descendant leaves.</p></dd>


<dt>message</dt>
<dd><p>A logical scalar, indicating whether progress messages
should be printed to the console.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a TreeSummarizedExperiment object.</p><ul><li><p><strong>assays</strong> A list of count matrices, with entities in rows and
    samples in columns. Each row can be mapped to a node of the tree.</p></li>
<li><p><strong>rowData</strong> Annotation data for the rows.</p></li>
<li><p><strong>colData</strong> Annotation data for the columns.</p></li>
<li><p><strong>rowTree</strong> The tree structure of entities.</p></li>
<li><p><strong>rowLinks</strong> The link between rows and nodes on the tree.</p></li>
<li><p><strong>metadata</strong> More details about the simulation.</p><ul><li><p><strong>FC</strong> the fold change of entities corresponding to the
        tree leaves.</p></li>
<li><p><strong>Branch</strong> the information about two selected branches.</p><ul><li><p><strong>A</strong> The branch node label (or number) of branch A.</p></li>
<li><p><strong>B</strong> The branch node label (or number) of branch B.</p></li>
<li><p><strong>ratio</strong> The count proportion ratio of branch B to
            branch A.</p></li>
<li><p><strong>A_tips</strong> The number of leaves on branch A.</p></li>
<li><p><strong>B_tips</strong> The number of leaves on branch B.</p></li>
<li><p><strong>A_prop</strong> The count proportion of branch A.</p></li>
<li><p><strong>B_prop</strong> The count proportion of branch B.</p></li>
</ul></li>
</ul></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Simulate a count table for entities which are corresponding to the
    nodes of a tree. The entities are in rows and the samples from different
    groups or conditions are in columns. The library size of each sample is
    sampled from a Negative Binomial distribution with mean and size
    specified by the arguments <code>mu</code> and <code>size</code>. The counts of
    entities, that are mapped to the leaf nodes, in a sample are assumed
    to follow a Dirichlet-Multinomial distribution. The parameters for
    the Dirichlet-Multinomial distribution are estimated from a real data set
    specified by <code>data</code> via the function <code>dirmult</code> (see
    <code><a href="https://rdrr.io/pkg/dirmult/man/dirmult.html" class="external-link">dirmult</a></code>). To generate different abundance patterns
    under different conditions, we provide three different scenarios,
    “BS”, “US”, and “SS” (specified via
    <code>scenario</code>).</p><ul><li><p>BS: two branches are selected to swap their proportions,
    and leaves on the same branch have the same fold change.</p></li>
<li><p>US: two branches are selected to swap their proportions. Leaves
    in the same branch have different fold changes but same
    direction (either increase or decrease).</p></li>
<li><p>SS: two branches are selected. One branch has its proportion
    swapped with the proportion of some leaves from the other branch.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Ruizhu Huang, Charlotte Soneson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TreeSummarizedExperiment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Generate data to use as the starting point (this would usually be a</span></span></span>
<span class="r-in"><span><span class="co">## real data set)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fl">120</span>, size <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">tinyTree</span><span class="op">$</span><span class="va">tip.label</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">toy_lse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-constructor.html" class="external-link">TreeSummarizedExperiment</a></span><span class="op">(</span>rowTree <span class="op">=</span> <span class="va">tinyTree</span>,</span></span>
<span class="r-in"><span>                                    assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">simData</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">toy_lse</span>, ratio <span class="op">=</span> <span class="fl">2</span>, scenario <span class="op">=</span> <span class="st">"BS"</span>, pct <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 1: Log-likelihood value: -2142.56163506266</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 2: Log-likelihood value: -2140.22864492689</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 3: Log-likelihood value: -2139.95865725141</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 4: Log-likelihood value: -2139.95301764506</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 5: Log-likelihood value: -2139.95301439773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: TreeSummarizedExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 10 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(3): FC branch scenario</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(10): t2 t7 ... t5 t3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(100): C1_1 C1_2 ... C2_49 C2_50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(1): group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reducedDimNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mainExpName: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> altExpNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowLinks: a LinkDataFrame (10 rows)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowTree: 1 phylo tree(s) (10 leaves)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colLinks: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colTree: NULL</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ruizhu Huang, Charlotte Soneson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

