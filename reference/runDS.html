<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Test for differential state using edgeR — runDS • treeclimbR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Test for differential state using edgeR — runDS"><meta property="og:description" content="Test for differential state of entities using functions from the
edgeR package. This adapts edgerWrp to accept
input as a
SummarizedExperiment (SE) object
instead of matrix. Each assay should correspond to data
for one node of the tree. Samples are in columns and
features are in rows. The sample information is
in colData. The tree that stores the hierarchical relation between
the assays is provided via the argument tree."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">treeclimbR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/treeclimbR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/csoneson/treeclimbR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test for differential state using edgeR</h1>
    <small class="dont-index">Source: <a href="https://github.com/csoneson/treeclimbR/blob/HEAD/R/runDS.R" class="external-link"><code>R/runDS.R</code></a></small>
    <div class="hidden name"><code>runDS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Test for differential state of entities using functions from the
<code>edgeR</code> package. This adapts <code><a href="edgerWrp.html">edgerWrp</a></code> to accept
input as a
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></code> (SE) object
instead of <code>matrix</code>. Each <code>assay</code> should correspond to data
for one node of the tree. Samples are in columns and
features are in rows. The sample information is
in <code>colData</code>. The tree that stores the hierarchical relation between
the <code>assays</code> is provided via the argument <code>tree</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">runDS</span><span class="op">(</span></span>
<span>  <span class="va">SE</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  option <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glm"</span>, <span class="st">"glmQL"</span><span class="op">)</span>,</span>
<span>  design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_min_count <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  filter_min_total_count <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  filter_large_n <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  filter_min_prop <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_cells <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  normalize_method <span class="op">=</span> <span class="st">"TMM"</span>,</span>
<span>  group_column <span class="op">=</span> <span class="st">"group_id"</span>,</span>
<span>  design_terms <span class="op">=</span> <span class="st">"group_id"</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>SE</dt>
<dd><p>A <code>SummarizedExperiment</code> object, typically generated by
<code>aggDS</code>.</p></dd>


<dt>tree</dt>
<dd><p>A <code>phylo</code> object. Each <strong>assay</strong> of <code>SE</code>
stores data for one node of the tree.</p></dd>


<dt>option</dt>
<dd><p>Either <code>"glm"</code> or <code>"glmQL"</code>. If <code>"glm"</code>,
<code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html" class="external-link">glmFit</a></code> and <code><a href="https://rdrr.io/pkg/edgeR/man/glmLRT.html" class="external-link">glmLRT</a></code> are used;
otherwise, <code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFit.html" class="external-link">glmQLFit</a></code> and
<code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFTest.html" class="external-link">glmQLFTest</a></code> are used. Details about the difference
between two options are in the help page of
<code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFit.html" class="external-link">glmQLFit</a></code>.</p></dd>


<dt>design</dt>
<dd><p>A numeric design matrix. If <code>NULL</code>, all columns of
the sample annotation will be used to create the design matrix.</p></dd>


<dt>contrast</dt>
<dd><p>A numeric vector specifying one contrast of
the linear model coefficients to be tested equal to zero. Its length
must equal to the number of columns of design. If <code>NULL</code>, the last
coefficient will be tested equal to zero.</p></dd>


<dt>filter_min_count</dt>
<dd><p>A numeric value, passed to <strong>min.count</strong> of
<code><a href="https://rdrr.io/pkg/edgeR/man/filterByExpr.html" class="external-link">filterByExpr</a></code>.</p></dd>


<dt>filter_min_total_count</dt>
<dd><p>A numeric value, passed to
<strong>min.total.count</strong> of <code><a href="https://rdrr.io/pkg/edgeR/man/filterByExpr.html" class="external-link">filterByExpr</a></code>.</p></dd>


<dt>filter_large_n</dt>
<dd><p>A numeric value, passed to <strong>large.n</strong> of
<code><a href="https://rdrr.io/pkg/edgeR/man/filterByExpr.html" class="external-link">filterByExpr</a></code>.</p></dd>


<dt>filter_min_prop</dt>
<dd><p>A numeric value, passed to <strong>min.prop</strong> of
<code><a href="https://rdrr.io/pkg/edgeR/man/filterByExpr.html" class="external-link">filterByExpr</a></code>.</p></dd>


<dt>min_cells</dt>
<dd><p>A numeric scalar specifying the minimal number of cells
in a node required to include a node in the analysis. The information
about the number of cells per node and sample should be available in
<code>metadata(SE)$n_cells</code>. A node is retained if at least half of the
samples have at least <code>min_cells</code> cells belonging to the node.</p></dd>


<dt>normalize</dt>
<dd><p>A logical scalar indicating whether to estimate
normalization factors (using <code><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html" class="external-link">calcNormFactors</a></code>).</p></dd>


<dt>normalize_method</dt>
<dd><p>Normalization method to be used. See
<code><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html" class="external-link">calcNormFactors</a></code> for more details.</p></dd>


<dt>group_column</dt>
<dd><p>The name of the column in the sample annotation
providing group labels for samples. This annotation is used for
filtering.</p></dd>


<dt>design_terms</dt>
<dd><p>The names of columns from the sample annotation
that will be used to generate the design matrix. This is ignored if
<strong>design</strong> is provided.</p></dd>


<dt>message</dt>
<dd><p>A logical scalar, indicating whether progress messages
should be printed.</p></dd>


<dt>...</dt>
<dd><p>More arguments to pass to <code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html" class="external-link">glmFit</a></code>
(<code>option = "glm"</code> or <code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFit.html" class="external-link">glmQLFit</a></code>
(<code>option = "glmQL"</code>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with entries <strong>edgeR_results</strong>, <strong>tree</strong>, and
<strong>nodes_drop</strong>.</p><dl><dt>edgeR_results</dt>
<dd><p>A list. Each of the elements contains the output of
         <code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFTest.html" class="external-link">glmQLFTest</a></code> or
         <code><a href="https://rdrr.io/pkg/edgeR/man/glmLRT.html" class="external-link">glmLRT</a></code> for one node, depending on the specified
         <code>option</code>.</p></dd>

    <dt>tree</dt>
<dd><p>The hierarchical structure of entities that was stored in the
         input <code>SE</code>.</p></dd>

    <dt>nodes_drop</dt>
<dd><p>A vector storing the alias node labels of entities
         that are filtered before analysis due to low counts.</p></dd>


</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Ruizhu Huang</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TreeSummarizedExperiment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Load example data</span></span></span>
<span class="r-in"><span><span class="va">ds_tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ds_sim_20_500_8de.rds"</span>,</span></span>
<span class="r-in"><span>                              package <span class="op">=</span> <span class="st">"treeclimbR"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ds_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggDS.html">aggDS</a></span><span class="op">(</span>TSE <span class="op">=</span> <span class="va">ds_tse</span>, assay <span class="op">=</span> <span class="st">"counts"</span>, sample_id <span class="op">=</span> <span class="st">"sample_id"</span>,</span></span>
<span class="r-in"><span>               group_id <span class="op">=</span> <span class="st">"group"</span>, cluster_id <span class="op">=</span> <span class="st">"cluster_id"</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Multiple nodes are found to have the same label.</span>
<span class="r-in"><span><span class="co">## Information about the number of cells is provided in the metadata</span></span></span>
<span class="r-in"><span><span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">ds_se</span><span class="op">)</span><span class="op">$</span><span class="va">n_cells</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            4   1   2   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_1   10   8  14  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_2   17  12  10  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_3    9   9  18  11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_4   14  13  14   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_5   11   9  13  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_6   15  14  13  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_7   16  18  16  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_8   17  13  15   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_9    7  12  13  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_10  12  11  12  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_11 128 119 138 115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_12 116 108 126 103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_13  36  29  42  37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_14  26  21  28  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_15  80  79  84  66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_16  73  67  71  53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_17  40  36  40  33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_18  25  22  27  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alias_19  33  31  31  20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ds_res</span> <span class="op">&lt;-</span> <span class="fu">runDS</span><span class="op">(</span>SE <span class="op">=</span> <span class="va">ds_se</span>, tree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-accessor.html" class="external-link">colTree</a></span><span class="op">(</span><span class="va">ds_tse</span><span class="op">)</span>, option <span class="op">=</span> <span class="st">"glmQL"</span>,</span></span>
<span class="r-in"><span>                group_column <span class="op">=</span> <span class="st">"group"</span>, contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                filter_min_count <span class="op">=</span> <span class="fl">0</span>, filter_min_total_count <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">ds_se</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                filter_min_prop <span class="op">=</span> <span class="fl">0</span>, min_cells <span class="op">=</span> <span class="fl">5</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 nodes are ignored, as they don't contain at least 5 cells in at least half of the samples.</span>
<span class="r-in"><span><span class="co">## Top differential features (across nodes)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="nodeResult.html">nodeResult</a></span><span class="op">(</span><span class="va">ds_res</span>, type <span class="op">=</span> <span class="st">"DS"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            logFC   logCPM        F       PValue          FDR node feature</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3...1   1.646616 16.31850 2758.468 1.599434e-38 6.077849e-36   11       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5...2  -1.577228 16.18364 2634.842 3.949545e-38 7.504136e-36   13       5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6...3  -1.633327 16.19005 2551.386 7.446819e-38 9.432638e-36   13       6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1...4   1.623166 16.28457 2237.433 9.866162e-37 9.372854e-35   11       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6...5  -1.566620 16.27571 1962.617 1.293029e-35 9.827017e-34   11       6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5...6  -1.529990 16.26806 1808.583 6.414163e-35 4.062303e-33   11       5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       1.537199 16.20796 1704.764 2.039174e-34 1.106980e-32   13       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3...8   1.640742 16.31547 1629.871 4.906269e-34 2.330478e-32   12       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1...9   1.610791 16.27523 1314.615 3.230517e-32 1.363996e-30   12       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6...10 -1.577420 16.27036 1212.677 1.546389e-31 5.850031e-30   12       6</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ruizhu Huang, Charlotte Soneson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

